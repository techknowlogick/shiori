language: go

go_import_path: src.techknowlogick.com/shiori

node_js:
  - 10

services:
  - docker

script:
  - docker build -t techknowlogick/shiori:latest .
  - go get -t -v ./...
  - go vet $(go list ./... | grep -v /vendor/)
  - make fmt-check
  - make dist
  - go build
  - ./shiori add https://example.com
  - ./shiori print

deploy:
  provider: script
  script: bash docker_push
  on:
    branch: master
